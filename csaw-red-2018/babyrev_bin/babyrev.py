#!/bin/env python

rax = 0
rbx = 0
rcx = 0
rdx = 0
rsi = 0
rdi = 0

def print_reg():
	print 'rax = ' + hex(rax)
	print 'rbx = ' + hex(rbx)
	print 'rcx = ' + hex(rcx)
	print 'rdx = ' + hex(rdx)
	print 'rsi = ' + hex(rsi)
	print 'rdi = ' + hex(rdi)

original_rand = 0x6b8b4567
def check_original(inp, rand):
	rdx = inp
	rax = rand

	rdx = (0xa3d70a3d70a3d70b * rand) >> 70 - (rand >> 0x3f)
	print hex(rdx)
	# rdx = rdx - (rand >> 63)
	rax = ((rand - rdx * 100) ^ inp)
	# rax ^ inp = 0x668
	# inp = rax ^ 0x668
	print 'rax*3 check: ' + str(hex(rax * 3) == '0xd83L')
	# print 'rbx = ' + hex(rbx)
	# print 'rcx = ' + hex(rcx)
	# print 'rdx = ' + hex(rdx)
	# print 'rsi = ' + hex(rsi)
	# print 'rdi = ' + hex(rdi)
	return rax == 0x668

	# ((0x1338 / 3) ^ inp) = (rand - rdx * 100)
	# rdx = (rand - (0x668 ^ inp)) / 100

def get_solution(rand):
	print 0x668 ^ (rand - (((0xa3d70a3d70a3d70b * rand) >> 70) * 100))

# check_original(1234, original_rand)
# get_solution(0x643c9869)


get_solution(0x6b8b4567)
get_solution(0x327b23c6)
get_solution(0x643c9869)
get_solution(0x66334873)
get_solution(0x74b0dc51)
get_solution(0x19495cff)
get_solution(0x2ae8944a)
get_solution(0x625558ec)
get_solution(0x238e1f29)
get_solution(0x46e87ccd)
get_solution(0x3d1b58ba)
get_solution(0x507ed7ab)
get_solution(0x2eb141f2)
get_solution(0x41b71efb)
get_solution(0x79e2a9e3)
get_solution(0x7545e146)
get_solution(0x515f007c)
get_solution(0x5bd062c2)
get_solution(0x12200854)
get_solution(0x4db127f8)
get_solution(0x216231b)
get_solution(0x1f16e9e8)
get_solution(0x1190cde7)
get_solution(0x66ef438d)
get_solution(0x140e0f76)
get_solution(0x3352255a)
get_solution(0x109cf92e)
get_solution(0xded7263)
get_solution(0x7fdcc233)
get_solution(0x1befd79f)
get_solution(0x41a7c4c9)
get_solution(0x6b68079a)
get_solution(0x4e6afb66)
get_solution(0x25e45d32)
get_solution(0x519b500d)
get_solution(0x431bd7b7)
get_solution(0x3f2dba31)
get_solution(0x7c83e458)
get_solution(0x257130a3)
get_solution(0x62bbd95a)
get_solution(0x436c6125)
get_solution(0x628c895d)
get_solution(0x333ab105)
get_solution(0x721da317)
get_solution(0x2443a858)
get_solution(0x2d1d5ae9)
get_solution(0x6763845e)
get_solution(0x75a2a8d4)
get_solution(0x8edbdab)
get_solution(0x79838cb2)
get_solution(0x4353d0cd)
get_solution(0xb03e0c6)
get_solution(0x189a769b)
get_solution(0x54e49eb4)
get_solution(0x71f32454)
get_solution(0x2ca88611)
get_solution(0x836c40e)
get_solution(0x2901d82)
get_solution(0x3a95f874)
get_solution(0x8138641)
get_solution(0x1e7ff521)
get_solution(0x7c3dbd3d)
get_solution(0x737b8ddc)
get_solution(0x6ceaf087)
get_solution(0x22221a70)
get_solution(0x4516dde9)
get_solution(0x3006c83e)
get_solution(0x614fd4a1)
get_solution(0x419ac241)
get_solution(0x5577f8e1)
get_solution(0x440badfc)
get_solution(0x5072367)
get_solution(0x3804823e)
get_solution(0x77465f01)
get_solution(0x7724c67e)
get_solution(0x5c482a97)
get_solution(0x2463b9ea)
get_solution(0x5e884adc)
get_solution(0x51ead36b)
get_solution(0x2d517796)
get_solution(0x580bd78f)
get_solution(0x153ea438)
get_solution(0x3855585c)
get_solution(0x70a64e2a)
get_solution(0x6a2342ec)
get_solution(0x2a487cb0)
get_solution(0x1d4ed43b)
get_solution(0x725a06fb)
get_solution(0x2cd89a32)
get_solution(0x57e4ccaf)
get_solution(0x7a6d8d3c)
get_solution(0x4b588f54)
get_solution(0x542289ec)
get_solution(0x6de91b18)
get_solution(0x38437fdb)
get_solution(0x7644a45c)
get_solution(0x32fff902)
get_solution(0x684a481a)
get_solution(0x579478fe)
get_solution(0x749abb43)