b main
r
si
r <<< $(printf '\x20\x13\x04')
disas main
b 0x400ca8
b *0x400ca8
r
disas main
b *0x400bf5
del 1
r
si
fin
si
fin
si
b *0x400c13
del 2
si
del 3
si
fin
si
fin
si
fin
si
b *0x400c82
si
disas objc_msg_lookup
checksec
set disable-randomization off
r
q
set disable-randomization off
r
b *0x400c82
r
si
si
set disable-randomization on
r
si
r
si
heap
info proc map
r <<< $(printf '\xa0\x4a\x66')
si
r <<< $(printf '\xa0\xd6\xff\xff\xff\x7f')
si
r <<< $(printf '\xa0\xd6\xff\xff\xff\x7f\x00')
si
info b
q
i b
b *0x400c82
r < output
si
c
disas objc_msg_lookup()
disas objc_msg_lookup
r 
args clear
clea rargs
clear args
set args
r
si
seachmem Aa0
searchmem Aa0
info proc m
r < output
si
r < output
si
r
si
disas objc_msg_lookup
r <<< $(printf 'AAAAAAAA')
si
si
r <<< $(printf 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA')
si
si
r < output
si
r
si
r
si
r
si
set environment LD_PRELOAD
set environment LD_PRELOAD libs/libobjc.so.4.0.0
r
si
q
disas main
b *0x400c82
set environment LD_PRELOAD ./libobjc.so.4.0.0
r
si
r < output
si
disas objc_msg_lookup
r < output
si
r <<< $(printf 'AAAAAAAAAAAAAAAAAAAAAAAAAAAA'(
r <<< $(printf 'AAAAAAAAAAAAAAAAAAAAAAAAAAAA')
si
ni
ni
r
si
r < output
si
si
si
r
si
si
r
si
r
si
c
r
c
r
c
r
c
r
c
r
r
r
r
c
r
si
r
r
si
r
si
x/xw 0x602010
x/xg 0x602010
r
si
info proc m
x/64xw 0x602000
x/64xg 0x602000
x/64xw 0x602000
r
si
x/xg 0x602000
x/64xg 0x602000
x/64xw 0x602000
r
si
disas objc_msg_lookup
x/xw 0x602000
x/64xw 0x602000
r
si
r
si
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
si
searchmem bin
searchmem bin/sh
set disable-randomization off
r
searchmem bin/sh
si
r
searchmem bin/sh
si
x/64xg 0x602010
find \xcb\xc9\x7f\x00
find \x7f\x00
find \xc9\x7f\x00
x/64xg 0x601250
b main
r
si
fin
si
fin
si
fin
si
fin
si
fin
si
fin
si
fin
si
fin
si
b *0x400c5c
del 1
r
si
fin
si
si
r
si
fin
si
fin
sii
fin
si
disas main
b *0x400cab
r
c
